[ホームに戻る](index.md)  
| [第1話](DigitalOut_explain.md) →


# 第0話　マイコンプログラミングとは/環境構築しよう
　まず手始めとして、マイコンプログラミングの概要について説明します。マイコンを使って何か作ったことがある人は読み飛ばしていただいて結構です。また、同時にmbedの環境構築もこの項で行います。

## マイコンとは？
　マイコンとは、ロボット等を作るときに使われる小さなコンピュータです。よく使われるものでは、ArduinoやNucleoが挙げられます。ロ技研ではNucleoシリーズを用いています。以下の写真は「Nucleo F303K8」というマイコンで、Nucleoシリーズの中でもロ技研でよく使われているマイコンの一つです。

<div style="text-align: center;">
<image src = "./img/pins.png" alt = "sample_F303K8" title = "sample_F303K8" width = "300" height = "200"/>
</div>

　マイコンは様々な電子部品がついていますが、注目すべきは上図の3つです。それぞれ説明します。
1. USBポート<br/>
    　文字通りUSBポートがついていて、パソコンと接続することができます。F303K8の場合は、micro B端子のメスがついています。これを通じてPCからプログラムを書き込んだり、マイコンが読んだセンサーの情報をPC側でモニターすることができます。
2. リセットボタン<br/>
    　このボタンを押すことでプログラムをリセット・再実行できます。便利なので覚えておきましょう。
3. ピン<br/>
    　マイコンで最も大事なのがこの「ピン」です。F303K8には30個のピンがついています。それぞれが電気信号を入出力できますが、場所によってできることが異なるので、マイコンを使うときはあらかじめマイコンの仕様を調べておきましょう。F303K8のピンのレファレンスは [こちら](https://os.mbed.com/platforms/ST-Nucleo-F303K8/) にあります。

　マイコンのピンを回路につないでLEDやUSB、センサー類に電気を流すわけです。

<div style="text-align: center;">
<image src = "./img/moshiki_2.png" alt = "sample_F303K8" title = "sample_F303K8" width = "400" height = "200"/>
</div>

## mbedとは
mbedは、いろいろなマイコンを **同じプログラミング言語（C++）** で動かすことができる枠組み（フレームワークという）です。ロ技研ではmbedでマイコンプログラミングを行います。
## PlatformIOとは
PlatformIOは、いろいろなフレームワークを**同じ開発環境**でプログラミングできるものです。これをVisual Studio Codeに導入することで、VSCode上でmbedのプログラムを作成・書き込みすることができます。

# 環境構築しよう
それではマイコンプログラミングをするための環境をあなたのPCに構築しましょう。前提として、
- C++の開発環境の構築
- Visual Studio Codeの導入
はすでに完了しているものとします。

## PlatformIOの導入
まずPlatformIOを導入しましょう。これはVSCodeの拡張機能としてインストールできます。<br/>

1. VScodeの画面左側の拡張機能のボタンをクリックして（または`ctrl`+`shift`+`x`）、検索バーで「PlatformIO」を検索<br/>
<div style="text-align: center;">
<image src = "./img/PIO_intro.png" alt = "sample_F303K8" title = "sample_F303K8" width = "400" height = "200"/>
</div>

2. インストールボタンを押して、インストールしましょう。インストールが終わると、先ほどの画像のようになります。
3. VSCodeを再起動しましょう。PlatformIOのロゴ（アリの顔？エイリアン？）がツールバーに表示されるはずです。
※　初回は特に読み込みに時間がかかるので、しばらく待ちましょう。
<div style="text-align: center;">
<image src = "./img/PIO_intro2.png" alt = "sample_F303K8" title = "sample_F303K8" width = "400" height = "200"/>
</div>
4. アイコンが表示されたら完了です。PlatformIOでのプロジェクトの作り方は次の記事で取り上げます。

参考: 環境構築時にトラブルがあった場合は [こちら](./platformio.md) を参照してください。

## Zadigを導入
PlatformIOで作ったプログラムをUSB経由でマイコンに書き込む時に、エラーになることがよくあります。そこで、zadigというソフトでUSBドライバの設定を変更します。

1. [こちら](https://zadig.akeo.ie/)のサイトにアクセスしましょう。見た目はかなり怪しいサイトですが大丈夫です。

2. インストールを押しましょう。広告が出てきますが冷静に`閉じる`を押せばOKです。
3. そのままインストールしてください。各種設定はデフォルトのままで大丈夫です。
※　**マイコンとPCを接続した状態で**インストールを行ってください。

これで環境構築は終わりです。次の記事から、具体的なmbedでのプログラミングのやり方を紹介します。

### 注意
PlatformIOは日本語に対応していないので、プログラムを書くファイル（ソースファイル）への絶対パス内に**日本語があると読み込めない**ことがあります。必ずユーザーネームも含めて英数字にしておきましょう。
